<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Caliper Corporation" />

<meta name="date" content="2021-02-08" />

<title>Networks</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>




<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">TRMG2</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Databases
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="tazs_and_se_data.html">TAZs and SE Data</a>
    </li>
    <li>
      <a href="networks.html">Networks</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Surveys
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="survey_processing.html">Household Survey</a>
    </li>
    <li>
      <a href="obs_processing.html">On-Board Survey</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Resident Models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="population_synthesis.html">Synthesis</a>
    </li>
    <li>
      <a href="auto_ownership.html">Auto Ownership</a>
    </li>
    <li>
      <a href="resident_production.html">Production</a>
    </li>
    <li>
      <a href="time_of_day.html">Time of Day</a>
    </li>
    <li>
      <a href="resident_nonmotorized.html">Non-motorized</a>
    </li>
    <li>
      <a href="parking.html">Parking</a>
    </li>
    <li>
      <a href="nhb.html">Non-homebased</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="accessibility.html">Accessibility</a>
    </li>
    <li>
      <a href="airport.html">Airport</a>
    </li>
    <li>
      <a href="ieei.html">Internal/External</a>
    </li>
    <li>
      <a href="commercial_vehicles.html">Commercial Vehicles</a>
    </li>
    <li>
      <a href="assignment_roadway.html">Roadway Assignment</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Caliper-Corporation/TRMG2">Github</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Networks</h1>
<h4 class="author">Caliper Corporation</h4>
<h4 class="date">February 8, 2021</h4>

</div>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The highway and transit networks are critical inputs for any travel model. They provide travel time, accessibility, and other impedance information. The Caliper team used the various existing data sources from the model stakeholders together with other sources including the TIGER line files and review with satellite imagery in order to fashion a new master layer for both roadways and transit.</p>
<p>This documentation uses the term “network” specifically to refer to the machine- readable files (.net and .tnw) TransCAD uses for shortest pathing and assignment. The GIS files that planners and modelers review and edit are referred to as layers. This language is something Caliper is trying to promote to clarify which data component is being referenced.</p>
</div>
<div id="roadway-layer" class="section level2">
<h2>Roadway Layer</h2>
<div id="creation-of-the-master-layer" class="section level3">
<h3>Creation of the master layer</h3>
<p>Like TRMv6, the TRMG2 model uses a master layer that contains all projects stakeholders might consider during transportation plan development (including competing ideas). This allows each scenario layer to be exported from the master with little or no manual editing. Information on using the project management tool is covered in the user guide.</p>
<p>The previous highway layer made heavy use of numeric codes that translated into values (e.g. a facility type of 1 might signify interstate). For TRMG2, these fields now contain the string values directly, which improves understanding, usability, and maintenance of the layer. It also makes the model’s GISDK code easier to read.</p>
<p>For these same reasons, the previous “Special” field was broken up into new HOV and Toll-related fields. For example, the “TollType” field includes values like “Free”, “Toll”, and “HOT” (for high-occupancy toll lane). It is easier to understand a query like “TollType = ‘Toll’” compared to “Special = 43”. For a full enumeration of field names and meanings, see the user guide.</p>
<p>The Caliper team also updated the master layer to reflect a 2016 base year, the target year for model estimation (the final layer is a 2020 base year and will be accompanied by a 2020 year model validation process). In other words, if you export a scenario layer without any projects it will reflect the 2016 road system. This was done by permanently modifying the base attributes of the master layer with any projects scheduled to be complete by the base year date. This did include some road closures, and those links dropped out of the layer permanently.</p>
</div>
<div id="update-of-count-data" class="section level3">
<h3>Update of count data</h3>
<p>The count data was provided to Caliper by the Stakeholders. The original source of this info was NCDOTs 2017 traffic count program along with a special count collection effort undertaken specifically for model validation. All counts were factored to an Average Weekday Daily Traffic (AWDT) for April 2017.</p>
<p>The previous model used a separate table to hold count data which then had to be joined to the layer to make comparisons. For TRMG2, the basic count data including station ID and daily AWDT were added to the master layer directly. This makes it easier to compare (either manually or in code) between model volumes and count data. Additional information (such as hourly counts) can still be maintained in a separate table and joined to the layer only as needed.</p>
</div>
<div id="link-layer-conflation" class="section level3">
<h3>Link layer conflation</h3>
<p>Caliper reviewed every link in the road line layer comparing against satellite imagery. Alignments were adjusted to match the imagery. Many links were adjusted, but most adjustments were small. The alignment of many ramps were corrected and collector/distributor systems were added if they were missing.</p>
<div class="figure" style="text-align: center">
<img src="img/networks/capital_before.png" alt="Capital before and after" width="49%" height="20%" /><img src="img/networks/capital_after.png" alt="Capital before and after" width="49%" height="20%" />
<p class="caption">
Capital before and after
</p>
</div>
</div>
<div id="adding-all-streets" class="section level3">
<h3>Adding all streets</h3>
<p>After conflating the existing links to improve alignments with aerials, Caliper upgraded the road layer to include all streets. These additional streets provide a much better representation of the walk and transit paths travelers actually take, and are shown in orange below.</p>
<div class="figure" style="text-align: center">
<img src="img/networks/all_streets.png" alt="All-Streets Network" width="60%" height="40%" />
<p class="caption">
All-Streets Network
</p>
</div>
<p>Caliper added a <code>PrimaryLink</code> field to the line layer. It can be used to easily select the gray or orange links depending on what the user wants to do.</p>
<ul>
<li><code>PrimaryLink = 1</code>: Gray links</li>
<li><code>PrimaryLink = 0</code>: Orange links</li>
</ul>
<p>These queries will also be used to make roadway and transit layer creation easier. The minor streets do not have attribute information and should not be included for use by vehicle travel. They will only be used by non-motorized and transit travelers.</p>
</div>
<div id="review-of-all-streets" class="section level3">
<h3>Review of All Streets</h3>
<p>With all the changes mentioned above, it was important to check that the new master projects remained consistent. To be exhaustive, Caliper wrote code to do this programmatically. For instance, every project in the old master layer had its length checked against the new layer. Of the well over 1000 projects, only 6 had length discrepancies. Each was investigated and corrected as necessary.</p>
<p>Shortest paths were also built with the TRMv6 and TRMG2 layers using free-flow times based on posted speeds. Comparison of the resulting matrices showed that overall the RMSE was only 0.25%, which is very small, indicating close consistency between the layers. The increased confidence that nothing was broken. Additionally, every OD pair with an absolute percentage change greater than 30% was reviewed. The largest relative difference was 62% for one OD pair (between zone 1535 and 1444); in that case, the review revealed that the new layer was correct while the original TRMv6 layer allowed a U-turn where it should not have. See the before and after images below.</p>
<div class="figure" style="text-align: center">
<img src="img/networks/path_before.png" alt="Pathing before and after" width="49%" height="20%" /><img src="img/networks/path_after.png" alt="Pathing before and after" width="49%" height="20%" />
<p class="caption">
Pathing before and after
</p>
</div>
<p>A small number of OD pairs were reviewed with changes &lt;30%, but each one was reasonable.</p>
</div>
<div id="posted-speed-and-lanes-review" class="section level3">
<h3>Posted speed and lanes review</h3>
<p>In addition to checks on the conflation and addition of all streets, Caliper also reviewed the network for attribute correctness. For this review, Caliper used <a href="https://connect.ncdot.gov/resources/gis/Pages/GIS-Data-Layers.aspx">NCDOTs Road Characteristics layer</a>. This was overlaid with the master layer to visually check for discrepancies. Google Streeview was also used occasionally to check lanes and speed limit signs.</p>
</div>
<div id="tolls" class="section level3">
<h3>Tolls</h3>
<p>Tolling is an important policy lever for the Triangle. The Triangle Expressway is an approximately 18 mile long freeway that charges a toll. In addition, the region is considering additional toll facilities include high-occupancy toll (HOT) lanes in the future.</p>
<p>Toll rates were collected from the <a href="https://www.ncquickpass.com/rates-facilities/Pages/toll-rates.aspx">NC Quick Pass website</a>. Small links representing the toll gantries were added to the link layer. This approach makes it easy to add accurate toll prices to the network. If a user crosses the gantry link, they pay the listed price. In the image below, the first price is for travelers with a transponder and the second is for those without.</p>
<p><img src="img/networks/toll_gantry.png" width="262" /></p>
<p>The TRMG2 does not predict transponder ownership, but has parameters to describe the percent of toll users that have one. For the base year, the parameters were calculated using data obtained from NC Turnpike Authority. These allowed transponder utilization to be calculated by vehicle class as shown in the table below.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Vechile Class
</th>
<th style="text-align:right;">
Transponder %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Auto
</td>
<td style="text-align:right;">
72
</td>
</tr>
<tr>
<td style="text-align:left;">
SUT
</td>
<td style="text-align:right;">
70
</td>
</tr>
<tr>
<td style="text-align:left;">
MUT
</td>
<td style="text-align:right;">
76
</td>
</tr>
</tbody>
</table>
<p>These parameters can be modified during scenario planning.</p>
<p>Finally, the model automatically increases the toll rates for single- and multi-unit trucks based on the stated policy of the turnpike. SUT pay double the listed price while MUT pay four times as much.</p>
</div>
<div id="bus-speeds" class="section level3">
<h3>Bus Speeds</h3>
<p>For express and local buses, the TRMG2 uses factors to determine bus speeds based on auto speeds. The table below shows the factors, which vary by roadway classification and area type, and were borrowed from the <a href="https://scag.ca.gov/data-tools-modeling">SCAG model</a> in California. These were then reviewed for reasonableness by local transit agencies.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
HCMType
</th>
<th style="text-align:left;">
AreaType
</th>
<th style="text-align:right;">
Local Bus Factor
</th>
<th style="text-align:right;">
Express Bus Factor
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Freeway
</td>
<td style="text-align:left;">
Downtown
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
0.85
</td>
</tr>
<tr>
<td style="text-align:left;">
Freeway
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
0.85
</td>
</tr>
<tr>
<td style="text-align:left;">
Freeway
</td>
<td style="text-align:left;">
Suburban
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
Freeway
</td>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
MLHighway
</td>
<td style="text-align:left;">
Downtown
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
0.85
</td>
</tr>
<tr>
<td style="text-align:left;">
MLHighway
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
0.85
</td>
</tr>
<tr>
<td style="text-align:left;">
MLHighway
</td>
<td style="text-align:left;">
Suburban
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
MLHighway
</td>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
TLHighway
</td>
<td style="text-align:left;">
Downtown
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
0.85
</td>
</tr>
<tr>
<td style="text-align:left;">
TLHighway
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
0.85
</td>
</tr>
<tr>
<td style="text-align:left;">
TLHighway
</td>
<td style="text-align:left;">
Suburban
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
TLHighway
</td>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
Superstreet
</td>
<td style="text-align:left;">
Downtown
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;">
Superstreet
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;">
Superstreet
</td>
<td style="text-align:left;">
Suburban
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
Superstreet
</td>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
MajorArterial
</td>
<td style="text-align:left;">
Downtown
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;">
MajorArterial
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;">
MajorArterial
</td>
<td style="text-align:left;">
Suburban
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
MajorArterial
</td>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
Arterial
</td>
<td style="text-align:left;">
Downtown
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;">
Arterial
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;">
Arterial
</td>
<td style="text-align:left;">
Suburban
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
Arterial
</td>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
MajorCollector
</td>
<td style="text-align:left;">
Downtown
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;">
MajorCollector
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;">
MajorCollector
</td>
<td style="text-align:left;">
Suburban
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
MajorCollector
</td>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
Collector
</td>
<td style="text-align:left;">
Downtown
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;">
Collector
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;">
Collector
</td>
<td style="text-align:left;">
Suburban
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
Collector
</td>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
Local
</td>
<td style="text-align:left;">
Downtown
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;">
Local
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;">
Local
</td>
<td style="text-align:left;">
Suburban
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
Local
</td>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="transit-layer" class="section level2">
<h2>Transit Layer</h2>
<p>TRMG2 adds a master layer for transit routes along with a project manager specially designed to transfer routes accurately between line layers. This enhancement greatly reduces the burden of coding and managing projects between various base and future year scenarios.</p>
<p>More detail on how to use the new tools are included in the user’s guide, but information on the creation of the master route system requires a basic understanding of the tool. In short, the transit project manager finds the shortest path between route stops to reconstruct the route on a new layer. This approach struggles when route stops are not frequent enough to get an accurate path, but TRMG2 solves this problem using “shape stops”. These are extra stops along the route that are used to improve alignment, but are then removed.</p>
<p>The maps below give a good example of a potential problem when transferring routes between layers using only stop locations only. The shortest path between stops is not always the route a bus takes.</p>
<div class="figure" style="text-align: center">
<img src="img/networks/1%20route%20without%20shape%20points.png" alt="Transferring without shape points" width="49%" height="20%" /><img src="img/networks/2%20route%20without%20shape%20points%20result.png" alt="Transferring without shape points" width="49%" height="20%" />
<p class="caption">
Transferring without shape points
</p>
</div>
<p>The maps below show how a single shape stop solves the alignment problem while maintaining the correct number of stops.</p>
<div class="figure" style="text-align: center">
<img src="img/networks/3%20route%20with%20shape%20points.png" alt="Transferring with shape points" width="49%" height="20%" /><img src="img/networks/4%20route%20with%20shape%20points%20result.png" alt="Transferring with shape points" width="49%" height="20%" />
<p class="caption">
Transferring with shape points
</p>
</div>
<p>Each time a scenario is created, the transit project manager writes out a file next to the route system detailing how accurate the transfer went. This is achieved by comparing lengths before and after as well as checking for any missed stops. Shape stops can be added until the match is exact, but minor differences in route lengths do not have a measurable impact on model results. The table below provides a sample of the comparison table.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
projid
</th>
<th style="text-align:right;">
master_route_id
</th>
<th style="text-align:right;">
scenario_route_id
</th>
<th style="text-align:right;">
master_length
</th>
<th style="text-align:right;">
scenario_length
</th>
<th style="text-align:right;">
diff
</th>
<th style="text-align:right;">
pct_diff
</th>
<th style="text-align:right;">
missing_stops
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
250
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
9.2
</td>
<td style="text-align:right;">
9.0
</td>
<td style="text-align:right;">
-0.1
</td>
<td style="text-align:right;">
-1.2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
278
</td>
<td style="text-align:right;">
106
</td>
<td style="text-align:right;">
9.7
</td>
<td style="text-align:right;">
9.6
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
-0.2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
328
</td>
<td style="text-align:right;">
132
</td>
<td style="text-align:right;">
14.4
</td>
<td style="text-align:right;">
14.3
</td>
<td style="text-align:right;">
-0.1
</td>
<td style="text-align:right;">
-0.8
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
329
</td>
<td style="text-align:right;">
133
</td>
<td style="text-align:right;">
14.3
</td>
<td style="text-align:right;">
14.2
</td>
<td style="text-align:right;">
-0.1
</td>
<td style="text-align:right;">
-0.7
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
5.5
</td>
<td style="text-align:right;">
5.5
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
4.2
</td>
<td style="text-align:right;">
4.2
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<div id="transit-networking-checking" class="section level3 tabset">
<h3>Transit networking checking</h3>
<p>Transit networks are the files TransCAD uses for shortest path, assignment, and other procedures (extension: “tnw”). During the model run, the route system file is converted into many different networks. In TRMG2, a separate transit network file is created for each combination of</p>
<ul>
<li>Time of Day
<ul>
<li>AM</li>
<li>MD</li>
<li>PM</li>
<li>NT</li>
</ul></li>
<li>Transit Mode
<ul>
<li>Local Bus</li>
<li>Express Bus</li>
<li>Bus Rapid Transit (if present)</li>
<li>Commuter Rail (if present)</li>
<li>Light Rail (if present)</li>
</ul></li>
<li>Access Mode
<ul>
<li>Walk</li>
<li>Kiss-and-Ride (aka drop off)</li>
<li>Park-and-Ride</li>
</ul></li>
</ul>
<p>Creating separate files facilitates the critical step of auditing the networks. The model translates the route, stop, link, and node layers into a transit network, and it is important to make sure the networks are behaving appropriately. In the TRMG2, for example, the AM and PM PNR networks behave differently. In the AM, where trips are primarily from home to destinations like work, drive access works in the PA direction:</p>
<ol style="list-style-type: decimal">
<li>Drive to a PNR lot</li>
<li>Walk to the bus access stop</li>
<li>Ride the bus to the egress stop</li>
<li>Walk to the final destination</li>
</ol>
<p>In the PM network, trips are primarily back to home. For this reason, the drive access flow is reversed.</p>
<ol style="list-style-type: decimal">
<li>Walk to the access stop</li>
<li>Ride the bus to the egress stop</li>
<li>Walk to the PNR lot</li>
<li>Drive home</li>
</ol>
<p>TransCAD can handle this behavior, but it is always important to check that the model code is setup correctly. Separate network files allowed the two maps below to be created quickly to confirm proper behavior.</p>
<div id="pnr-am" class="section level4">
<h4>PNR AM</h4>
<p><img src="img/networks/pnr_am.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="pnr-pm" class="section level4">
<h4>PNR PM</h4>
<p><img src="img/networks/pnr_pm.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>

<br>
<br>
<br>
<hr>
<p><a href="https://www.caliper.com/">Caliper Corporation</a>, 2021</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>


</body>
</html>
